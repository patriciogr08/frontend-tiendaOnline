<ion-header>
    <ion-toolbar>
        <ion-title>{{ mode === 'create' ? 'Nuevo producto' : 'Editar producto' }}</ion-title>
        <ion-buttons slot="end">
        <ion-button (click)="close()">Cerrar</ion-button>
        </ion-buttons>
    </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
    <form [formGroup]="form" (ngSubmit)="save()">
        <ion-list lines="full">
            <ion-item>
                <ion-select label="Tipo" labelPlacement="floating" formControlName="tipo_producto_id">
                <ion-select-option [value]="null">Sin tipo</ion-select-option>
                <ion-select-option *ngFor="let t of tipos" [value]="t.id">{{ t.nombre }}</ion-select-option>
                </ion-select>
            </ion-item>

            <ion-item>
                <ion-input label="Nombre" labelPlacement="floating" formControlName="nombre"></ion-input>
            </ion-item>

            <ion-item>
                <ion-input label="Descripción" labelPlacement="floating" formControlName="descripcion"></ion-input>
            </ion-item>

            <ion-item>
                <ion-input type="number" label="Precio" labelPlacement="floating" formControlName="precio"></ion-input>
            </ion-item>

            <ion-item>
                <ion-toggle formControlName="publicado">Publicado</ion-toggle>
            </ion-item>

            <ion-item>
                <ion-toggle formControlName="tiene_descuento">¿Tiene descuento?</ion-toggle>
            </ion-item>
            @if(form.value.tiene_descuento){
                <ion-input type="number" label="Descuento" labelPlacement="floating" formControlName="descuento"></ion-input>
                <ion-input type="number" label="% Porcentaje" labelPlacement="floating" formControlName="porcentaje"></ion-input>
            }
            <app-image-picker
                label="Foto del producto"
                [previewUrl]="model?.foto_url || null"
                (fileChange)="setFile($event)">
            </app-image-picker>
        </ion-list>

        <div class="actions">
            <ion-button type="button" fill="clear" (click)="close()">Cancelar</ion-button>
            <ion-button type="submit" [disabled]="form.invalid">Guardar</ion-button>
        </div>
    </form>
</ion-content>
